<% id = "create_field_field_group_#{@field.field_group_id}";
   custom_field_id = "custom_field_#{@field.id}";
   container_id = "fields_field_group_#{@field.field_group_id}";
   create_field_id = "create_field_field_group_#{@field.field_group_id}";
   empty_field_id = "empty_opportunity_field_group_#{@field.field_group_id}"
%>

<% if @field.valid? %>
  jQuery("#<%=id%>_arrow").html(crm.COLLAPSED)
  jQuery('#<%=create_field_id%>').before('<%= j (render :partial => "field", :collection => [@field]) %>')
  jQuery('#<%=create_field_id%>').before('<%= j (sortable_element(container_id, :url => sort_admin_fields_path(:field_group_id => @field.field_group_id))) %>')
  jQuery('#<%=custom_field_id%>').effect("highlight", { duration:1500 });
  jQuery("#<%=create_field_id%>").hide();
  jQuery("#<%=empty_field_id%>").hide();
<% else %>
  jQuery('#<%=id%>').html('<%= j(render :partial => "admin/fields/form", :locals => {:field_group_id => @field.field_group_id} ) %>')
  jQuery('#<%=id%>').effect("shake", { duration:250, distance: 6 });
  jQuery('#<%=id%>').find('input[type="text"]').first().focus()
<% end %>
